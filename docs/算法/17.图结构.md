# 图结构

## 介绍

图是网络结构的抽象模型，由一组 **边** 和 **顶点** 组成。下图就是一个典型的图结构：

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-03-121821.png" alt="image-20250303201821109" style="zoom:40%;" />

**相关术语**

1. 顶点：图里面一个一个数据元素被称之为 **顶点**。之前在线性表中称之为元素，树里面称之为节点。

   另外，线性表可以没有元素（空表），树里面可以没有节点（空树），但是在图结构中不能够没有顶点。

2. 相邻顶点：由一条边连接在一起的两个顶点，称之为相邻顶点。

3. 度：一个顶点的相邻顶点的数量。

4. 路径：指的是一连串顶点序列。其中有一个概念称之为 **简单路径**，指的就是 **不包含** 重复顶点的路径。

5. 环：从某一个顶点出发，最后回到该顶点，形成了一个闭环。环也会算作是一个简单路径。



**无向图和有向图**

1. 无向图：顾名思义就是 **顶点之间是没有方向的**

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-03-120233.png" alt="image-20250303200232935" style="zoom:40%;" />

由于是无方向的，因此连接 A 和 D 的边，可以表示为 `(A, D)`，也可以写成`(D, A)`。对于无向图来讲，`G = (V,{E})`，其中顶点集合 `V = {A,B,C,D}`，边集合 `E = {(A,B), (B,C), (C,D), (D,A), (A,C)}`

在无向图中，如果**每一个顶点都和其他所有顶点相连**，则称该无向图为 **无向完全图**。如下图所示：

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-03-131346.png" alt="image-20250303211346799" style="zoom:40%;" />

一个含有 n 个顶点的无向完全图拥有
$$
\frac{n*(n-1)}{2}
$$

条边。例如上面的无向完全图有 4 个顶点，根据公式计算出拥有 6 条边。



2. 有向图：顶点之间 **有明确的方向**

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-03-121207.png" alt="image-20250303201206757" style="zoom:40%;" />

有向图是有方向的，使用 **尖括号** 来表示，尖括号中的第一个节点表示 tail，第二个节点表示 head。例如上图为 `G = (V,{E})`，其中顶点集合 `V = {A,B,C,D}`，边集合 `E = {<A,D>, <B,A>, <C,A>, <B,C>}`。

在有向图中，如果 **任意两个顶点之间都存在方向相反的指向**，称之为 **有向完全图**。例如下图就是一个有向完全图：

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-12-045950.png" alt="image-20250312125950523" style="zoom:35%;" />



**加权图**

图还可以是加权的。如下图所示，加权图的 **边被赋予了权值**。

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-03-125916.png" alt="image-20250303205916275" style="zoom:40%;" />



**子图**

假设有两个图，一个图是 G = (V, {E})，另一个图是 G' = (V', {E'})，如果
$$
\begin{aligned}
V' &\subseteq V \\
E' &\subseteq E
\end{aligned}
$$
那么我们称 G' 为 G 的子图。

举个例子：

![image-20250312131312298](https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-12-051312.png)


## 图的存储

### 邻接矩阵

所谓邻接矩阵，本质上就是使用一个 **二维数组** 来存储图。举个例子，假设有如下的 **有向图**：

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-12-053737.png" alt="image-20250312133737628" style="zoom:40%;" />

那么使用一个二维数组存储的结构如下：
$$
\left[
\begin{matrix}
0 & 1 & 0 & 1 & 0\\
0 & 0 & 0 & 0 & 1\\
0 & 1 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0\\
0 & 0 & 1 & 0 & 0
\end{matrix}
\right]
$$
每一行代表一个顶点，每一列也代表一个顶点。例如上面的图有 5 个顶点，那么这个二维数组就是 5 x 5 的二维数组。如果是 n 个顶点，那么这个二维数组就是 n x n。

1 表示顶点之间是有连接关系的。V1 顶点连接 V2，因此第一行第二列就是 1，V1 顶点连接 V4，因此第一行第四列就是 1.



接下来是无向图，如下：

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-12-054803.png" alt="image-20250312134803244" style="zoom:40%;" />

使用邻接矩阵的表示法来表示的话，如下：
$$
\left[
\begin{matrix}
0 & 1 & 0 & 1 & 0\\
1 & 0 & 1 & 0 & 1\\
0 & 1 & 0 & 1 & 1\\
1 & 0 & 1 & 0 & 0\\
0 & 1 & 1 & 0 & 0
\end{matrix}
\right]
$$
因为无向路是没有方向的，因此 V1 顶点连接 V2 顶点的同时，V2 顶点也连接 V1 顶点。





**带边权的图**

另外，我们知道图可以是带边权的，此时在二维数组中 **存储的就是具体的边权值**，而非简单的记入 1。

下面是具体的例子。首先是带边权的有向图：

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-12-055412.png" alt="image-20250312135412244" style="zoom:40%;" />

表示出来就是：
$$
\left[
\begin{matrix}
\infty & 5 & \infty & 4 & \infty\\
\infty & \infty & \infty & \infty & 4\\
\infty & 1 & \infty & \infty & \infty\\
\infty & \infty & 2 & \infty & \infty\\
\infty & \infty & 2 & \infty & \infty
\end{matrix}
\right]
$$
注意，现在没有相连的两个顶点，不能用 0 来表示，因为 0 会存在歧义，被误解为边权值。JS 里面就可以使用 Infinity



下面是带边权的无向图示例：

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-12-060033.png" alt="image-20250312140032926" style="zoom:40%;" />

表示出来就是：
$$
\left[
\begin{matrix}
\infty & 5 & \infty & 4 & \infty\\
5 & \infty & 1 & \infty & 4\\
\infty & 1 & \infty & 2 & 2\\
4 & \infty & 2 & \infty & \infty\\
\infty & 4 & 2 & \infty & \infty
\end{matrix}
\right]
$$
使用邻接矩阵来存储图的优缺点如下：

**优点**

（1）容易判断两个顶点是否有边，例如要判断 V1 和 V2 这两个顶点是否有边，只需要看二维数组 `arr[0][1]` 和 `arr[1][0]` 是否有值即可。

（2）容易计算顶点的度。度还可以分为 **出度** 和 **入度**。V2 顶点的出度，指的是 V2 顶点指向其他边的数量，下图中 V2 顶点的出度就是 1. 入度指的是指向当前顶点的边的数量，V2 的入度就为 2.

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-12-053737.png" alt="image-20250312133737628" style="zoom:40%;" />

上图使用邻接矩阵表示出来：
$$
\left[
\begin{matrix}
0 & 1 & 0 & 1 & 0\\
0 & 0 & 0 & 0 & 1\\
0 & 1 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0\\
0 & 0 & 1 & 0 & 0
\end{matrix}
\right]
$$
该顶点对应的行的 1 的数量就是该顶点 **出度** 的数量，该顶点对应的列的 1 的数量就是 **入度** 的数量。



**缺点**

（1）统计 **边的数量** 的效率较低，需要去遍历二维数组，时间复杂度为 `O(n²)`

（2）空间复杂度高，因为是二维数组来存储，因此空间复杂度也是 `O(n²)`


### 邻接表

例如下面的图：

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-12-062302.png" alt="image-20250312142302485" style="zoom:40%;" />

上面的图虽然有 5 个顶点，但是仅仅有顶点 2 连接顶点 1，如果用上面我们介绍过的邻接矩阵的方式来存储的话，就是：
$$
\left[
\begin{matrix}
\infty & \infty & \infty & \infty & \infty\\
9 & \infty & \infty & \infty & \infty\\
\infty & \infty & \infty & \infty & \infty\\
\infty & \infty & \infty & \infty & \infty\\
\infty & \infty & \infty & \infty & \infty
\end{matrix}
\right]
$$
上面的二维数组，仅仅只存储了一个 9，其他空间都浪费掉了。因此这里可以考虑使用邻接表的方式来存储。



**邻接表核心思想**

邻接表的核心思想是使用一个 **一维数组** 来存储所有的顶点，因此有多少个顶点，这个一维数组的长度就是多少。数组里面的每一项是一个 **链表**，**链表会存储和该顶点连接的所有其他顶点**。

我们还是来看一个具体的例子，假设还是下面的有向图：

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-27-044231.png" alt="image-20250327124230602" style="zoom:50%;" />

那么使用数组存储的结构如下：

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-12-071230.png" alt="image-20250312151229515" style="zoom:40%;" />

数组的每一项，是一个链表。这里以 V1 顶点为例。V1 指向了 V2 和 V4，V2 和 V4 这两个顶点在数组中的下标分别为 1

和 3，因此整个链表如蓝色部分所示。

> 注意这里 V2 和 V4 并**不存在具体的顺序**，因此在链表中的表现也可以是下标为 3 的顶点在前面，下标为 1 的顶点在后面。



因此，上面的有向图使用邻接表来存储的话，完整的邻接表为：

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-12-072442.png" alt="image-20250312152442563" style="zoom:40%;" />

搞清楚了有向图后，无向图基本也是相同的道理，仅仅是链表的长度会更长一些，因为会包含出度和入度。例如下面的无向图：

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-12-054803.png" alt="image-20250312134803244" style="zoom:40%;" />

使用邻接表的方式来存储的话，完整的数组结构如下图：

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-03-12-073104.png" alt="image-20250312153104203" style="zoom:40%;" />

