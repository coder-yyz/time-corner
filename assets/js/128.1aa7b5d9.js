(window.webpackJsonp=window.webpackJsonp||[]).push([[128],{644:function(t,s,a){"use strict";a.r(s);var e=a(2),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"如何打包发布应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何打包发布应用"}},[t._v("#")]),t._v(" 如何打包发布应用")]),t._v(" "),s("p",[t._v("当我们的应用开发完成后，下一步要做的就是对应用进行打包。")]),t._v(" "),s("h2",{attrs:{id:"react-native-cli-环境项目应用打包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#react-native-cli-环境项目应用打包"}},[t._v("#")]),t._v(" "),s("em",[t._v("React Native CLI")]),t._v(" 环境项目应用打包")]),t._v(" "),s("p",[t._v("Android 要求所有应用都有一个数字签名才会被允许安装在用户手机上，所以在把应用发布到应用市场之前，你需要先生成一个签名的 AAB 或 APK 包（Google Play 现在要求 AAB 格式，而国内的应用市场目前仅支持 APK 格式。但无论哪种格式，下面的签名步骤是一样的）。")]),t._v(" "),s("h3",{attrs:{id:"生成一个签名密钥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生成一个签名密钥"}},[t._v("#")]),t._v(" 生成一个签名密钥")]),t._v(" "),s("p",[t._v("你可以用 keytool 命令生成一个私有密钥。在 Windows 上 keytool 命令放在 JDK 的 bin 目录中（比如 C:\\Program Files\\Java\\jdkx.x.x_x\\bin），你可能需要在命令行中先进入那个目录才能执行此命令。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("keytool -genkeypair -v -storetype PKCS12 -keystore my-release-key.keystore -alias my-key-alias -keyalg RSA -keysize 2048 -validity 10000\n")])])]),s("p",[t._v("这条命令会要求你输入密钥库（"),s("em",[t._v("keystore")]),t._v("）和对应密钥的密码，然后设置一些发行相关的信息。最后它会生成一个叫做 "),s("em",[t._v("my-release-key.keystore")]),t._v(" 的密钥库文件。")]),t._v(" "),s("p",[t._v("在运行上面这条语句之后，密钥库里应该已经生成了一个单独的密钥，有效期为 "),s("em",[t._v("10000")]),t._v(" 天。"),s("em",[t._v("--alias")]),t._v(" 参数后面的别名是将来为应用签名时所需要用到的，所以记得记录这个别名。")]),t._v(" "),s("p",[t._v("切换目录到项目根目录下，具体操作如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2022-07-20-054203.png",alt:"image-20220720134202756"}})]),t._v(" "),s("blockquote",[s("p",[t._v("注意：请记得妥善地保管好你的密钥库文件，一般不要上传到版本库或者其它的地方。")])]),t._v(" "),s("h3",{attrs:{id:"设置-gradle-变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置-gradle-变量"}},[t._v("#")]),t._v(" 设置 gradle 变量")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("把 my-release-key.keystore 文件放到你工程中的 android/app 文件夹下。")])]),t._v(" "),s("li",[s("p",[t._v("编辑~/.gradle/gradle.properties（全局配置，对所有项目有效）或是项目目录/android/gradle.properties（项目配置，只对所在项目有效）。如果没有 gradle.properties 文件你就自己创建一个，添加如下的代码（注意把其中的\\\\替换为相应密码）")])])]),t._v(" "),s("blockquote",[s("p",[t._v("注意：~符号表示用户目录，比如 windows 上可能是 C:\\Users\\用户名，而 mac 上可能是/Users/用户名。")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("MYAPP_RELEASE_STORE_FILE=my-release-key.keystore\nMYAPP_RELEASE_KEY_ALIAS=my-key-alias\nMYAPP_RELEASE_STORE_PASSWORD=\nMYAPP_RELEASE_KEY_PASSWORD=\n")])])]),s("p",[t._v("具体操作如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2022-07-20-054220.png",alt:"image-20220720134220560"}})]),t._v(" "),s("p",[t._v("其中最后两行的 "),s("em",[t._v("PASSWORD")]),t._v(" 要替换为上面在创建 "),s("em",[t._v("my-release-key.keystore")]),t._v(" 的密钥库文件时所输入的密码。")]),t._v(" "),s("h3",{attrs:{id:"把签名配置加入到项目的-gradle-配置中"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#把签名配置加入到项目的-gradle-配置中"}},[t._v("#")]),t._v(" 把签名配置加入到项目的 gradle 配置中")]),t._v(" "),s("p",[t._v("编辑你项目目录下的 android/app/build.gradle，添加如下的签名配置：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("...\nandroid {\n    ...\n    defaultConfig { ... }\n    signingConfigs {\n        release {\n            if (project.hasProperty('MYAPP_RELEASE_STORE_FILE')) {\n                storeFile file(MYAPP_RELEASE_STORE_FILE)\n                storePassword MYAPP_RELEASE_STORE_PASSWORD\n                keyAlias MYAPP_RELEASE_KEY_ALIAS\n                keyPassword MYAPP_RELEASE_KEY_PASSWORD\n            }\n        }\n    }\n    buildTypes {\n        release {\n            ...\n            signingConfig signingConfigs.release\n        }\n    }\n}\n...\n")])])]),s("p",[t._v("具体操作如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2022-07-20-054237.png",alt:"image-20220720134237710"}})]),t._v(" "),s("h3",{attrs:{id:"生成发行-apk-包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生成发行-apk-包"}},[t._v("#")]),t._v(" 生成发行 APK 包")]),t._v(" "),s("p",[t._v("只需在终端中运行以下命令：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ cd android\n$ ./gradlew assembleRelease\n")])])]),s("blockquote",[s("p",[t._v("cd android 表示进入 android 目录（如果你已经在 android 目录中了那就不用输入了）。")])]),t._v(" "),s("p",[t._v("打包成功。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2022-07-20-054252.png",alt:"image-20220720134252892"}})]),t._v(" "),s("p",[t._v("最终，打包好的 "),s("em",[t._v("apk")]),t._v(" 文件存放于 "),s("em",[t._v("项目根目录/android/app/build/outputs/apk/release/")])]),t._v(" "),s("h3",{attrs:{id:"修改-app-名称与图标"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改-app-名称与图标"}},[t._v("#")]),t._v(" 修改 "),s("em",[t._v("APP")]),t._v(" 名称与图标")]),t._v(" "),s("p",[t._v("一般来讲，我们需要替换掉默认的应用图标和名称。方法如下：")]),t._v(" "),s("ul",[s("li",[t._v("修改 "),s("em",[t._v("app")]),t._v(" 的名称：在 "),s("em",[t._v("android/src/main/res/values/strings.xml")])])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("resources"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("string name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"app_name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("你的应用名称"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("string"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("resources"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("ul",[s("li",[t._v("修改 "),s("em",[t._v("app")]),t._v(" 图标：在 \\android/src/main/res/mipmap-\\ 里面的图片全部换成自己的图片")])]),t._v(" "),s("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2022-07-20-054310.png",alt:"image-20220720134309505"}}),t._v(" "),s("p",[t._v("替换之后重新打包项目即可。")]),t._v(" "),s("h2",{attrs:{id:"expo-环境应用打包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#expo-环境应用打包"}},[t._v("#")]),t._v(" "),s("em",[t._v("Expo")]),t._v(" 环境应用打包")]),t._v(" "),s("p",[t._v("在 "),s("em",[t._v("expo")]),t._v(" 中要打包项目非常简单。启动项目后，在浏览器端的控制台页面，选择“"),s("em",[t._v("Publish or republish project")]),t._v("”选项。")]),t._v(" "),s("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2022-07-20-054335.png",alt:"image-20220720134335005"}}),t._v(" "),s("p",[t._v("在右边的面板中，填写对应的信息，如下图：")]),t._v(" "),s("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2022-07-20-054431.png",alt:"image-20220720134431493"}}),t._v(" "),s("p",[t._v("之后点击【"),s("em",[t._v("Publish project")]),t._v("】按钮进行打包。打包完成后，会在控制台提示我们打包已经完成。")]),t._v(" "),s("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2022-07-20-054455.png",alt:"image-20220720134455712"}}),t._v(" "),s("p",[t._v("当出现该提示时，说明打包的应用已被放到 "),s("em",[t._v("expo")]),t._v(" 官网了。访问这个链接，可以看到我们发布的项目。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2022-07-20-054512.png",alt:"image-20220720134511653"}})]),t._v(" "),s("p",[t._v("点击【"),s("em",[t._v("Builds")]),t._v("】，可以看到打包后的应用的详细信息，在【"),s("em",[t._v("Status")]),t._v("】那一栏提供了下载链接，我们可以下载打包好的 "),s("em",[t._v("apk")]),t._v(" 文件，来进行发布。")]),t._v(" "),s("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2022-07-20-054525.png",alt:"image-20220720134525640"}}),t._v(" "),s("p",[t._v("当然，我们也可以通过命令的形式来进行打包，在 "),s("em",[t._v("app.json")]),t._v(" 文件中，可以进行更加详细的配置：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"expo"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"expo_app"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"slug"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"expo_app"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0.0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"orientation"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"portrait"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"icon"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./assets/icon.png"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"splash"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"image"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./assets/splash.png"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"resizeMode"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"contain"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"backgroundColor"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#ffffff"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"sdkVersion"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"38.0.0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"updates"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"fallbackToCacheTimeout"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"assetBundlePatterns"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"ios"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"supportsTablet"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"web"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"favicon"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./assets/favicon.png"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"android"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"package"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"com.test.expo_app"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"description"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("在该配置文件中，主要就是配置了应用的图标、版本等信息。")]),t._v(" "),s("p",[t._v("详细的配置选项，可以参阅：https://docs.expo.io/versions/latest/config/app/")]),t._v(" "),s("p",[t._v("接下来通过 "),s("em",[t._v("expo start")]),t._v(" 启动应用，然后新开一个窗口，通过 "),s("em",[t._v("exp build:android")]),t._v(" 来进行打包。")]),t._v(" "),s("blockquote",[s("p",[t._v("注：所以在上面的 "),s("em",[t._v("app.json")]),t._v(" 中，一定要有 "),s("em",[t._v("android")]),t._v(" 这个配置项。")])]),t._v(" "),s("p",[t._v("具体操作如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2022-07-20-054546.png",alt:"image-20220720134546250"}})]),t._v(" "),s("p",[t._v("整个打包过程会比较长，因为应用也会先被存储到 "),s("em",[t._v("expo")]),t._v(" 官网。")]),t._v(" "),s("p",[t._v("打包完成后，"),s("em",[t._v("expo")]),t._v(" 会给我们一个链接，通过该链接可以下载打包的 "),s("em",[t._v("apk")]),t._v(" 文件，然后就可以进行发布了。")])])}),[],!1,null,null,null);s.default=r.exports}}]);